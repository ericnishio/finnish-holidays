#!/usr/bin/env ruby
# encoding: UTF-8

require 'optparse'
require_relative '../lib/finnish-holidays'
require_relative '../lib/version'
require_relative '../lib/utils/date-utils'

options = {}

optparse = OptionParser.new do |opts|
  options[:count] = 3
  opts.on('-cCOUNT', '--count=COUNT', 'Number of holidays to show') do |count|
    options[:count] = count.to_i
  end

  options[:all] = false
  opts.on('-a', '--all', 'Include holidays falling on a weekend') do
    options[:all] = true
  end

  opts.on('-h', '--help', 'Show this screen') do
    puts opts
    exit
  end

  opts.on('-v', '--version', 'Show version') do
    puts FinnishHolidays::VERSION
    exit
  end
end

optparse.parse!

holidays = FinnishHolidays.holidays(options[:count], options[:all])
holidays.each do |holiday|
  t = DateUtils.create_date(holiday['year'], holiday['month'], holiday['day'])
  date = t.strftime('%a, %b %e, %Y')
  puts "#{date} #{holiday['description']}"
end
